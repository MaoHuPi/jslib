"use strict";class school1{constructor(t={}){this.path="https://maohupi.riarock.com/web/tool/318station/file",this.body=document.body,this.$_GET={},location.href.indexOf("?")>-1&&location.href.split("?")[1].split("&").forEach((t=>{t=t.split("="),this.$_GET[t[0]]=t[1]}));var e=location.href.split("/");if(this.page=e[e.length-1].split(".")[0],this.homeworkMode="op"in this.$_GET?this.$_GET.op:"view",this.copyP=this.createElement("p"),this.copyA=this.createElement("a"),this.copyP.style.margin="0px",this.copyP.style.padding="0px",this.copyP.style.width="0px",this.copyP.style.height="0px",this.copyP.style.position="fixed",this.copyP.style.top="0px",this.copyP.style.left="0px",this.copyP.style.fontSize="0px",this.copyP.style.color="transparent",this.copyP.style.opacity="0",this.copyP.style.pointerEvents="none",this.copyP.style.userSelect="text",this.copyP.style.zIndex="1",this.copyA.style.userSelect="text",this.copyP.appendChild(this.copyA),this.body.appendChild(this.copyP),this.maskMask=this.createElement("div"),this.maskBox=this.createElement("div"),this.maskGrid=this.createElement("ol"),this.maskMask.style.backgroundColor="#00000088",this.maskMask.style.position="fixed",this.maskMask.style.width="100vw",this.maskMask.style.height="100vh",this.maskMask.style.left="0px",this.maskMask.style.top="0px",this.maskMask.style.zIndex="9999",this.maskMask.style.opacity="0",this.maskMask.style.pointerEvents="none",this.maskMask.style.transition="0.5s",this.maskMask.style.border="none",this.maskMask.style.boxSizing="border-box",this.maskMask.style.margin="0px",this.maskBox.style.backgroundColor="#ffffff",this.maskBox.style.position="absolute",this.maskBox.style.width="95vw",this.maskBox.style.height="calc(100vh - 5vw)",this.maskBox.style.left="2.5vw",this.maskBox.style.top="2.5vw",this.maskBox.style.zIndex="10000",this.maskBox.style.borderRadius="1vw",this.maskBox.style.border="none",this.maskBox.style.boxSizing="border-box",this.maskBox.style.margin="0px",this.maskGrid.style.border="none",this.maskGrid.style.boxSizing="border-box",this.maskGrid.style.margin="0px 0px 0px 1em",this.maskMask.addEventListener("click",(()=>{this.maskClose()})),this.maskBox.addEventListener("click",(t=>{t.stopPropagation()})),window.addEventListener("keydown",(t=>{this.maskMask.opened&&"Escape"==t.key&&(t.preventDefault(),t.stopPropagation(),this.maskClose())})),this.maskMask.className="s1_maskMask",this.maskBox.className="s1_maskBox",this.maskGrid.className="s1_maskGrid",this.maskBox.appendChild(this.maskGrid),this.maskMask.appendChild(this.maskBox),this.body.appendChild(this.maskMask),this.homeworkTool={fullScreen:!1,copyContent:!1},"homeworkTool"in t)for(let e in this.homeworkTool)e in t.homeworkTool&&(this.homeworkTool[e]=t.homeworkTool[e]);if(this.editorTool={},"editorTool"in t)for(let e in this.editorTool)e in t.editorTool&&(this.editorTool[e]=t.editorTool[e]);this.show={homeworkTool:!1,editorTool:!1}}$(t,e=document){return e.querySelector(t)}$$(t,e=document){return e.querySelectorAll(t)}vw(){return window.innerWidth/100}vh(){return window.innerHeight/100}createElement(...t){return document.createElement(...t)}dictFilter(t,e){var s={};for(let o in t)e(t[o])&&(s[o]=t[o]);return s}copy(t,e){"text"==t&&(this.copyA.innerText=e);var s=window.getSelection(),o=document.createRange();o.selectNode(this.copyA),s.removeAllRanges(),s.addRange(o),document.execCommand("copy")}maskOpen(t){this.maskGrid.innerHTML=t,this.whileGDI(),this.maskMask.style.opacity="1",this.maskMask.style.pointerEvents="auto",this.maskMask.opened=!0}maskClose(){this.maskMask.style.opacity="0",this.maskMask.style.pointerEvents="none",this.maskGrid.innerHTML="",this.maskMask.opened=!1}whileGDI(){for(this.maskGrid.style.fontSize="2px";this.maskGrid.offsetWidth<this.maskBox.offsetWidth&&this.maskGrid.offsetHeight<this.maskBox.offsetHeight;)this.maskGrid.style.fontSize=parseInt(this.maskGrid.style.fontSize.replace("px",""))+1+"px";this.maskGrid.style.fontSize=parseInt(this.maskGrid.style.fontSize.replace("px",""))-1+"px"}isZoom(t=0,e=0){t===100*this.vw()&&e===100*this.vh()||(t=100*this.vw(),e=100*this.vh(),""!==this.maskGrid.innerHTML&&this.whileGDI()),setTimeout(((s=t,o=e)=>{this.isZoom(s,o)}),30)}addNewHomeworkMarkTool(){let t=this.$$("span.cke_toolbox > .cke_toolbar > .cke_toolgroup");for(let e=4;e<t.length;e+=5){let s=t.length>e&&t[e];if(0!=s){let t=document.createElement("span"),e=document.createElement("a"),o=document.createElement("span");function i(t){let o=s.offsetParent,n=!1;try{n=this.$('[role="presentation"].cke_contents > iframe',o)}catch(t){n=!1}if(0!=n){let s=n.contentWindow;if("getSelection"in s&&"extentNode"in s.getSelection()){let o=s.getSelection().extentNode.parentElement;"A"==o.tagName&&""===o.getAttribute("new")?(t.setAttribute("aria-pressed","true"),e.setAttribute("class","cke_button cke_button__strike cke_button_on")):(t.removeAttribute("aria-pressed"),e.setAttribute("class","cke_button cke_button__strike cke_button_off"))}}setTimeout(((e=t)=>{i(e)}),30)}t.setAttribute("class","cke_toolbar_separator"),t.setAttribute("role","separator"),s.appendChild(t),e.setAttribute("class","cke_button cke_button__strike cke_button_off"),e.setAttribute("href","javascript:void('新作業標籤')"),e.setAttribute("title","新作業標籤"),e.setAttribute("tabindex","-1"),e.setAttribute("hidefocus","true"),e.setAttribute("role","button"),e.setAttribute("aria-haspopup","false"),e.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation(),"true"==this.getAttribute("aria-pressed")?(this.removeAttribute("aria-pressed"),e.setAttribute("class","cke_button cke_button__strike cke_button_off")):(this.setAttribute("aria-pressed","true"),e.setAttribute("class","cke_button cke_button__strike cke_button_on"));let o=s.offsetParent,i=!1;try{i=this.$('[role="presentation"].cke_contents > iframe',o)}catch(t){i=!1}if(0!=i&&"getSelection"in window){let t=i.contentWindow;if(t.getSelection().extentNode){let e=t.document,s=t.getSelection().extentNode.parentElement,o=t.getSelection().anchorNode.parentElement;function i(t,s="set"){if("set"==s)if("A"==t.tagName)t.setAttribute("new","");else{let s=e.createElement("a");s.setAttribute("new",""),s.innerHTML=t.innerHTML,t.innerHTML="",t.appendChild(s)}else t.removeAttribute("new")}console.log(s),console.log(o);let n="set";"A"==s.tagName&&""===s.getAttribute("new")?(s.removeAttribute("new"),n="remove"):n="set",i(s,n),o!=s&&i(o,n)}}return!1})),e.addEventListener("focus",(function(){this.blur()})),o.innerHTML="&nbsp;",o.setAttribute("class","cke_button_icon"),o.style.backgroundImage="url('https://maohupi.riarock.com/web/tool/318station/file/markNEW.png')",o.style.backgroundSize="100%",o.style.backgroundPosition="center",e.appendChild(o),s.appendChild(e),i(e)}}}waitForCreatEditTool(t){if(this.$$("span.cke_toolbox > .cke_toolbar > .cke_toolgroup").length/5==4)for(let e in t)console.log(this),t[e].bind(this)();else setTimeout(this.waitForCreatEditTool,100,t)}init(){if(this.isZoom(),"homework"==this.page&&(this.show.homeworkTool="view"==this.homeworkMode&&Object.keys(this.dictFilter(this.homeworkTool,(t=>t))).length>0,this.show.editorTool="edit_form"==this.homeworkMode&&Object.keys(this.dictFilter(this.editorTool,(t=>t))).length>0),this.show.homeworkTool){this.$$(".breadcrumb ~ div .row > div > div:nth-child(1)").forEach((t=>{t.style.position="relative",t.content=t.parentElement.innerText;let e=this.createElement("div");if(e.className="s1_toolBar",e.style.height="100%",e.style.position="absolute",e.style.top="0px",e.style.right="0px",e.style.display="flex",e.style.flexDirection="row-reverse",e.style.alignContent="center",e.style.justifyContent="flex-start",e.style.flexWrap="nowrap",e.style.alignItems="center",e.style.boxSizing="content-box",e.innerButtonStyle=t=>{t.style.outline="none",t.style.margin="10.6px 10.6px 10.6px 0px",t.style.padding="0px",t.style.width="31.8px",t.style.height="31.8px",t.style.borderRadius="50%",t.style.backgroundSize="100%",t.style.backgroundColor="white",t.style.backgroundRepeat="no-repeat",t.style.backgroundPosition="center"},this.homeworkTool.fullScreen){let s=this.createElement("button");e.innerButtonStyle(s),s.style.backgroundImage=`url(${this.path}/fullscreen.svg)`,s.style.backgroundSize="100%",s.onclick=()=>{this.maskOpen("<li>"+t.content.split("\n").join("</li><li>")+"</li>")},e.appendChild(s)}if(this.homeworkTool.copyContent){let s=this.createElement("button");e.innerButtonStyle(s),s.style.backgroundImage=`url(${this.path}/content_copy.svg)`,s.style.backgroundSize="75%",s.onclick=()=>{this.copy("text",t.content.split("\n").map(((t,e)=>`${e+1}. ${t}`)).join("\n"))},e.appendChild(s)}t.appendChild(e)}))}if(this.show.editorTool){let t=[];this.homeworkTool.newhomeworkmark&&t.push(this.addNewHomeworkMarkTool),this.waitForCreatEditTool(t)}}}